{
    "appName": "MySparkStreamingApp",
    "batchInterval": 5,
    "source": {
        "type": "kafka",
        "read_config": {
            "bootstrap_servers": "localhost:9092",
            "input_topic": "test",
            "group_id": "MySparkStreamingApp",
            "key_deserializer": "org.apache.kafka.common.serialization.StringDeserializer",
            "value_deserializer": "org.apache.kafka.common.serialization.StringDeserializer"
        }
    },
    "transformations": [
        {
            "type": "filter",
            "params": {
                "column": "amount",
                "condition": "> 100"
            }
        },
        {
            "type": "select",
            "params": {
                "columns": [
                    "transaction_id",
                    "amount",
                    "customer_id",
                    "timestamp"
                ]
            }
        },
        {
            "type": "withColumn",
            "params": {
                "column": "amount_usd",
                "expression": "amount * 0.15"
            }
        },
        {
            "type": "drop",
            "params": {
                "columns": [
                    "description",
                    "account_number"
                ]
            }
        },
        {
            "type": "limit",
            "params": {
                "num": 100
            }
        }
    ],
    "sink": {
        "type": "write_to_kafka",
        "params":{
            "bootstrapServers": "localhost:9092",
            "topic": "transaction_output" ,
            "key_col": "transaction_id"  
        }
    }
}